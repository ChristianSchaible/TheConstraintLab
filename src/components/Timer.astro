---
---

<div id="timer-container" class="timer" role="button" tabindex="0" aria-pressed="false" aria-label="15 minute timer. Click to start or pause. Double-click to reset.">
  <div id="timer-display" class="time" aria-live="polite">15:00</div>
  <div id="timer-status" class="status">Click to start</div>
</div>

<style>
  .timer {
    display: inline-flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: 0.25rem;
    padding: 1rem 1.25rem;
    border: 2px solid var(--color-accent, #0ea5e9);
    border-radius: 12px;
    width: 12rem;
    cursor: pointer;
    user-select: none;
    background: white;
  }
  .timer:focus { outline: 3px solid rgba(14,165,233,0.25); }
  .time {
    font-size: 2rem;
    font-weight: 700;
    letter-spacing: 0.02em;
  }
  .status {
    font-size: 0.85rem;
    color: #666;
  }
  .timer.running { background: var(--color-accent) color: white; }
  .timer.paused { background:var(--color-accent); color: white; }
</style>

<script type="module">
  const DURATION = 15 * 60; // seconds
  const container = document.getElementById('timer-container');
  const display = document.getElementById('timer-display');
  const status = document.getElementById('timer-status');

  let remaining = DURATION;
  let intervalId = null;
  let running = false;

  function formatTime(s) {
    const m = Math.floor(s / 60).toString().padStart(2, '0');
    const sec = (s % 60).toString().padStart(2, '0');
    return `${m}:${sec}`;
  }

  function updateUI() {
    display.textContent = formatTime(remaining);
    if (running) {
      container.classList.add('running');
      container.classList.remove('paused');
      status.textContent = 'Running';
      container.setAttribute('aria-pressed', 'true');
    } else if (remaining !== DURATION && remaining !== 0) {
      container.classList.add('paused');
      container.classList.remove('running');
      status.textContent = 'Paused';
      container.setAttribute('aria-pressed', 'false');
    } else if (remaining === 0) {
      container.classList.remove('running');
      container.classList.remove('paused');
      status.textContent = 'Done';
      container.setAttribute('aria-pressed', 'false');
    } else {
      container.classList.remove('running');
      container.classList.remove('paused');
      status.textContent = 'Click to start';
      container.setAttribute('aria-pressed', 'false');
    }
  }

  function tick() {
    if (remaining <= 0) {
      clearInterval(intervalId);
      intervalId = null;
      running = false;
      remaining = 0;
      updateUI();
      return;
    }
    remaining -= 1;
    updateUI();
  }

  function start() {
    if (running) return;
    if (remaining <= 0) remaining = DURATION;
    running = true;
    updateUI();
    // align tick to next full second for better accuracy
    intervalId = setInterval(tick, 1000);
  }

  function pause() {
    if (!running) return;
    running = false;
    if (intervalId) {
      clearInterval(intervalId);
      intervalId = null;
    }
    updateUI();
  }

  function toggle() {
    if (running) pause(); else start();
  }

  function reset() {
    pause();
    remaining = DURATION;
    updateUI();
  }

  // Click toggles start/pause; double-click resets
  container.addEventListener('click', (e) => {
    toggle();
  });
  container.addEventListener('dblclick', (e) => {
    reset();
  });

  // Keyboard support: Space or Enter toggles, r resets
  container.addEventListener('keydown', (e) => {
    if (e.key === ' ' || e.key === 'Enter') {
      e.preventDefault();
      toggle();
    } else if (e.key.toLowerCase() === 'r') {
      reset();
    }
  });

  // Initialize UI
  updateUI();

  // Clean up on page unload
  window.addEventListener('beforeunload', () => {
    if (intervalId) clearInterval(intervalId);
  });
</script>
